<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ยาระบายตามสั่ง (Green)</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
  :root{
    --bg:#f3faf7;
    --card:#ffffff;
    --accent:#15803d;
    --accent-2:#10b981;
    --muted:#64748b;
    --glass: rgba(255,255,255,0.6);
    --radius:12px;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:Inter,system-ui,Arial,Helvetica,sans-serif;
    background: linear-gradient(180deg, #f8fff8 0%, var(--bg) 100%);
    color:#0f172a;
  }

  /* Header */
  header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:20px;
    gap:16px;
    background:transparent;
    border-bottom:1px solid rgba(15,23,42,0.04);
    position:sticky; top:0; z-index:10;
    backdrop-filter: blur(6px);
  }
  .brand {display:flex; gap:14px; align-items:center;}
  .logo img {
    width: 80px;      /* ปรับขนาด */
    height: auto;     /* รักษาสัดส่วน */
    object-fit: contain;
}

  h1{margin:0;font-size:18px}
  .tagline{color:var(--muted);font-size:13px}

  /* Layout */
  .wrap{
    max-width:1100px;margin:20px auto;padding:0 16px;display:grid;
    grid-template-columns: 1fr 360px; gap:20px;
  }
  @media(max-width:960px){ .wrap{grid-template-columns:1fr;padding:0 12px} }

  /* Controls */
  .controls{display:flex;gap:12px;align-items:center;margin-bottom:8px}
  .search{
    flex:1; display:flex; gap:8px; align-items:center;
    background:var(--card); padding:10px;border-radius:10px;box-shadow:0 6px 18px rgba(2,6,23,0.03);
  }
  .search input{border:0;outline:none;font-size:14px;width:100%}
  .filters{display:flex;gap:8px;align-items:center}
  .filters select, .filters button{
    padding:10px 12px;border-radius:10px;border:1px solid #e6f2ea;background:var(--card);cursor:pointer;
  }

  /* Products */
  .products{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px}
  .card{
    background:var(--card);border-radius:14px;padding:10px;display:flex;flex-direction:column;gap:10px;
    box-shadow:0 8px 24px rgba(16,185,129,0.06);transition:transform .18s, box-shadow .18s;
  }
  .card:hover{transform:translateY(-6px);box-shadow:0 18px 40px rgba(16,185,129,0.12)}
  .card img{width:100%;height:180px;object-fit:cover;border-radius:10px}
  .meta{display:flex;justify-content:space-between;align-items:center;gap:10px}
  .title{font-weight:600}
  .price{color:var(--accent);font-weight:700}
  .card .actions{display:flex;gap:8px;align-items:center}

  /* Sidebar cart */
  .cart{
    position:sticky; top:24px;background:var(--card);padding:16px;border-radius:14px;box-shadow:0 10px 28px rgba(2,6,23,0.06);
  }
  .cart h3{margin:0 0 8px 0}
  .cart-list{display:flex;flex-direction:column;gap:10px;max-height:420px;overflow:auto;padding-right:6px}
  .cart-item{display:flex;gap:10px;align-items:center;padding:8px;border-radius:10px;background:linear-gradient(180deg,rgba(16,185,129,0.03),transparent)}
  .cart-item img{width:72px;height:72px;object-fit:cover;border-radius:10px}
  .cart-item .name{font-weight:600}
  .qty-controls{display:flex;align-items:center;gap:6px}
  .qty-controls button{width:28px;height:28px;border-radius:8px;border:0;background:#e6f9ef;color:var(--accent);cursor:pointer}
  .remove-btn{background:transparent;border:0;color:#ef4444;cursor:pointer}

  .cart-summary{display:flex;justify-content:space-between;align-items:center;margin-top:12px;font-weight:700}
  .checkout-btn{width:100%;padding:12px;border-radius:10px;border:0;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;font-weight:700;cursor:pointer;margin-top:12px}

  /* Modal */
  .modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.45);display:none;align-items:center;justify-content:center;padding:16px;z-index:50}
  .modal{background:var(--card);padding:18px;border-radius:14px;max-width:520px;width:100%;box-shadow:0 18px 48px rgba(2,6,23,0.18)}
  .modal h3{margin-top:0}
  .row{display:flex;gap:8px}
  .row .col{flex:1}

  /* order history small */
  .history{margin-top:12px;font-size:13px;color:var(--muted)}
  .badge{display:inline-block;background:#f0fdf4;color:#065f46;padding:4px 8px;border-radius:999px;font-size:12px}

  /* utility */
  .muted{color:var(--muted);font-size:13px}
  .center{text-align:center}
</style>
</head>
<body>

<header>
  <div class="brand">
    <div class="logo">
        <img src="S.jpg" alt="Logo">
    </div>
      <h1>ยาระบายตามสั่ง</h1>
      <div class="tagline">อาหารจานด่วน ทำสดใหม่ | ส่งไว อุ่นใจ</div>
    </div>
  </div>

  <div style="display:flex;gap:12px;align-items:center">
    <div class="muted">สั่งออนไลน์ • เปิดบริการทุกวัน</div>
    <button style="padding:10px 14px;border-radius:10px;border:1px solid rgba(15,23,42,0.06);background:white;cursor:pointer" onclick="viewOrders()">ประวัติการสั่ง</button>
  </div>
</header>

<div class="wrap">
  <div>
    <div class="controls">
      <div class="search">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="opacity:.6"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="11" cy="11" r="6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <input id="search" placeholder="ค้นหาเมนู เช่น กะเพรา, ข้าวผัด" oninput="renderProducts()" />
      </div>

      <div class="filters">
        <select id="category" onchange="renderProducts()">
          <option value="">ทุกหมวด</option>
        </select>
        <button onclick="clearFilters()">ล้าง</button>
      </div>
    </div>

    <div class="products" id="products"></div>
  </div>

  <aside>
    <div class="cart">
      <h3>ตะกร้าของคุณ <span class="muted" style="font-weight:400">(<span id="cart-count">0</span> รายการ)</span></h3>

      <div class="cart-list" id="cart-list"></div>

      <div class="cart-summary">
        <div class="muted">ยอดรวม</div>
        <div id="cart-total">0 ฿</div>
      </div>

      <button class="checkout-btn" onclick="openCheckout()">ดำเนินการชำระเงิน</button>

      <div class="history" id="order-summary">
        <div><span class="badge" id="orders-count">0</span> คำสั่งซื้อที่ผ่านมา</div>
      </div>
    </div>
  </aside>
</div>

<!-- Checkout Modal -->
<div class="modal-backdrop" id="modal-backdrop">
  <div class="modal">
    <h3>ข้อมูลผู้สั่ง & ชำระเงิน</h3>

    <div style="display:flex;gap:8px;margin-bottom:10px">
      <input id="cust-name" placeholder="ชื่อ-นามสกุล" />
      <input id="cust-phone" placeholder="เบอร์โทร" />
    </div>

    <textarea id="cust-address" placeholder="ที่อยู่จัดส่ง (ระบุให้ชัด เช่น ซอย / ตึก / ชั้น)"></textarea>

    <div style="display:flex;gap:8px;margin-top:6px">
      <div style="flex:1">
        <label class="muted">วิธีชำระ</label>
        <select id="pay-method" onchange="toggleQR()">
          <option value="cod">เก็บเงินปลายทาง (COD)</option>
          <option value="qr">โอน (PromptPay / QR)</option>
        </select>
      </div>
      <div style="width:120px;display:flex;align-items:flex-end">
        <div id="checkout-total" style="font-weight:700;font-size:18px;text-align:right"></div>
      </div>
    </div>

    <div id="qr-block" style="display:none;margin-top:12px;text-align:center">
      <!-- ตัวอย่าง placeholder QR; เปลี่ยนเป็นของจริงได้ -->
      <img id="qr-img" src="so.jpg" style="width:220px;border-radius:8px;box-shadow:0 8px 24px rgba(2,6,23,0.08)" />
      <div class="muted" style="margin-top:8px">สแกนเพื่อชำระ จากนั้นอัปโหลดสลิป (ไม่บังคับสำหรับ demo)</div>
    </div>

    <div style="display:flex;gap:8px;margin-top:12px">
      <button style="flex:1;background:#ef4444" onclick="closeCheckout()">ยกเลิก</button>
      <button style="flex:1;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white" onclick="confirmCheckout()">ยืนยันการสั่งซื้อ</button>
    </div>

    <div style="margin-top:12px" id="checkout-msg"></div>
  </div>
</div>

<!-- Order history modal -->
<div class="modal-backdrop" id="orders-backdrop" style="display:none">
  <div class="modal">
    <h3>ประวัติการสั่งซื้อ</h3>
    <div id="orders-list" style="max-height:420px;overflow:auto"></div>
    <div style="display:flex;gap:8px;margin-top:12px">
      <button style="flex:1;background:#f3f4f6" onclick="closeOrders()">ปิด</button>
      <button style="flex:1;background:#111827;color:white" onclick="clearOrders()">ลบประวัติ</button>
    </div>
  </div>
</div>

<script>
/* DATA: เมนูอาหาร */
const PRODUCTS = [
  {id:1, title:'กะเพราไก่', price:55, cat:'จานด่วน', img:'https://recipe.sgethai.com/wp-content/uploads/2025/04/cover-kapraow-chicken.webp'},
  {id:2, title:'กะเพราหมู', price:65, cat:'จานด่วน', img:'https://www.theeateria.com/wp-content/uploads/2022/01/%E0%B8%81%E0%B8%B0%E0%B9%80%E0%B8%9E%E0%B8%A3%E0%B8%B2%E0%B8%AB%E0%B8%A1%E0%B8%B9.png'},
  {id:3, title:'ข้าวผัดกุ้ง', price:60, cat:'จานด่วน', img:'https://scontent.fbkk9-2.fna.fbcdn.net/v/t39.30808-6/501289448_1238184647672316_716592790094969280_n.jpg?stp=cp6_dst-jpg_s640x640_tt6&_nc_cat=109&ccb=1-7&_nc_sid=833d8c&_nc_ohc=wk5L7tAoOtIQ7kNvwE0_LJf&_nc_oc=AdlJnX-YYj-Lja0o2l77tNqWNPwlTGOvbxd63extkPLcCualXMu1zlVu-qNxt5-SUQajN1Oftd0_nWp28JkXB1Ol&_nc_zt=23&_nc_ht=scontent.fbkk9-2.fna&_nc_gid=sp9snvdH02Gpa4z6fbUQBg&oh=00_Afnih0gAWekTn-KSCRLi72e1JkslHqL6KJND9KLqzPK4AA&oe=6938EFF5'},
  {id:4, title:'ผัดซีอิ๊วหมู', price:55, cat:'ประเภทเส้น', img:'https://www.sgethai.com/wp-content/uploads/2022/03/220329-Content-%E0%B8%A7%E0%B8%B4%E0%B8%98%E0%B8%B5%E0%B8%97%E0%B8%B3%E0%B8%9C%E0%B8%B1%E0%B8%94%E0%B8%8B%E0%B8%B5%E0%B8%AD%E0%B8%B4%E0%B9%8A%E0%B8%A702.webp'},
  {id:5, title:'ก๋วยเตี๋ยวคั่วไก่', price:65, cat:'ประเภทเส้น', img:'https://fit-d.com/image_webp/f?src=./uploads/food/b765f45ff66c459c9efaa5b64fc25a2f.jpg'},
  {id:6, title:'ต้มยำกุ้ง', price:85, cat:'ต้ม-แกง', img:'https://img.wongnai.com/p/1968x0/2017/10/19/75678af28e394fbfb473fa1b417a62fc.jpg'},
  {id:7, title:'แกงเขียวหวานไก่', price:75, cat:'ต้ม-แกง', img:'https://recipe.ajinomoto.co.th/_next/image?url=https%3A%2F%2Fwww.ajinomoto.co.th%2Fstorage%2Fphotos%2Fshares%2FRecipe%2FMenu%2F3-19Greencurry%2F61a8f392ef73e.jpeg&w=3840&q=75'},
  {id:8, title:'หมูกระเทียม', price:55, cat:'จานด่วน', img:'https://gi.lnwfile.com/_/gi/_raw/tk/dp/5s.jpg'},
  {id:9, title:'ไข่ดาว', price:10, cat:'จานด่วน', img:'https://png.pngtree.com/thumb_back/fh260/background/20230815/pngtree-a-fried-egg-on-a-white-background-image_13069928.jpg'},
  {id:10, title:'ไข่เจียว', price:10, cat:'จานด่วน', img:'https://sp-ao.shortpixel.ai/client/to_avif,q_glossy,ret_img,w_1200/https://www.amarinbabyandkids.com/app/uploads/2022/05/%E0%B9%84%E0%B8%82%E0%B9%88%E0%B9%80%E0%B8%88%E0%B8%B5%E0%B8%A2%E0%B8%A7FB.jpg'}
];

/* STATE */
let cart = JSON.parse(localStorage.getItem('demo_cart_v1') || '{}'); // object {id:qty}
let orders = JSON.parse(localStorage.getItem('demo_orders_v1') || '[]');

/* INIT */
document.addEventListener('DOMContentLoaded', ()=>{
  populateCategories();
  renderProducts();
  renderCart();
  updateOrdersBadge();
});

/* CATEGORIES */
function populateCategories(){
  const sel = document.getElementById('category');
  const cats = Array.from(new Set(PRODUCTS.map(p => p.cat)));
  cats.forEach(c=>{
    const op = document.createElement('option'); op.value = c; op.textContent = c; sel.appendChild(op);
  });
}

/* RENDER PRODUCTS */
function renderProducts(){
  const box = document.getElementById('products');
  box.innerHTML = '';
  const q = document.getElementById('search').value.trim().toLowerCase();
  const cat = document.getElementById('category').value;

  PRODUCTS.filter(p=>{
    const matchQ = p.title.toLowerCase().includes(q) || p.cat.toLowerCase().includes(q);
    const matchCat = !cat || p.cat === cat;
    return matchQ && matchCat;
  }).forEach(p=>{
    const el = document.createElement('div'); el.className = 'card';
    el.innerHTML = `
      <img src="${p.img}" alt="${p.title}" loading="lazy" />
      <div class="meta">
        <div>
          <div class="title">${p.title}</div>
          <div class="muted" style="font-size:13px">${p.cat}</div>
        </div>
        <div class="price">${p.price} ฿</div>
      </div>
      <div class="actions">
        <div style="flex:1"></div>
        <button onclick="addToCart(${p.id})">+ ตะกร้า</button>
      </div>
    `;
    box.appendChild(el);
  });
}

/* CART FUNCTIONS */
function saveCart(){
  localStorage.setItem('demo_cart_v1', JSON.stringify(cart));
}
function addToCart(id){
  cart[id] = (cart[id] || 0) + 1;
  saveCart(); renderCart();
}
function removeFromCart(id){
  delete cart[id]; saveCart(); renderCart();
}
function changeQty(id, delta){
  const cur = cart[id] || 0;
  const next = Math.max(0, cur + delta);
  if(next === 0) delete cart[id]; else cart[id] = next;
  saveCart(); renderCart();
}
function renderCart(){
  const list = document.getElementById('cart-list');
  const countEl = document.getElementById('cart-count');
  const totalEl = document.getElementById('cart-total');
  list.innerHTML = '';

  let total = 0, count = 0;
  Object.keys(cart).forEach(id=>{
    const qty = cart[id];
    const p = PRODUCTS.find(x=>x.id == id);
    if(!p) return;
    count += qty;
    total += p.price * qty;

    const div = document.createElement('div'); div.className='cart-item';
    div.innerHTML = `
      <img src="${p.img}" alt="${p.title}" />
      <div style="flex:1">
        <div class="name">${p.title}</div>
        <div class="muted">${p.price} ฿ x ${qty} = ${p.price*qty} ฿</div>
        <div style="margin-top:8px" class="qty-controls">
          <button onclick="changeQty(${p.id}, -1)">−</button>
          <span style="padding:6px 10px;border-radius:8px;background:#fff;border:1px solid #f0f4f2;margin:0 6px">${qty}</span>
          <button onclick="changeQty(${p.id}, 1)">+</button>
          <button class="remove-btn" onclick="removeFromCart(${p.id})">ลบ</button>
        </div>
      </div>
    `;
    list.appendChild(div);
  });

  countEl.textContent = count;
  totalEl.textContent = total.toLocaleString('th-TH') + ' ฿';
  document.getElementById('checkout-total').textContent = total ? (total.toLocaleString('th-TH') + ' ฿') : '';
}

/* FILTER CLEAR */
function clearFilters(){
  document.getElementById('search').value = '';
  document.getElementById('category').value = '';
  renderProducts();
}

/* CHECKOUT (modal) */
function openCheckout(){
  const keys = Object.keys(cart);
  if(keys.length === 0){ alert('ตะกร้าว่าง — กรุณาเลือกเมนูก่อน'); return; }
  document.getElementById('modal-backdrop').style.display = 'flex';
  toggleQR();
}
function closeCheckout(){ document.getElementById('modal-backdrop').style.display = 'none'; document.getElementById('checkout-msg').innerHTML=''; }

/* toggle QR view */
function toggleQR(){
  const v = document.getElementById('pay-method').value;
  document.getElementById('qr-block').style.display = (v === 'qr') ? 'block' : 'none';
}

/* CONFIRM CHECKOUT */
function confirmCheckout(){
  const name = document.getElementById('cust-name').value.trim();
  const phone = document.getElementById('cust-phone').value.trim();
  const address = document.getElementById('cust-address').value.trim();
  const method = document.getElementById('pay-method').value;

  if(!name || !phone || !address){
    document.getElementById('checkout-msg').innerHTML = '<div style="color:#ef4444">กรุณากรอกข้อมูลให้ครบ</div>';
    return;
  }

  // build order
  let items = [], total = 0;
  Object.keys(cart).forEach(id=>{
    const p = PRODUCTS.find(x=>x.id == id);
    const qty = cart[id];
    items.push({id:p.id, title:p.title, price:p.price, qty});
    total += p.price * qty;
  });

  const order = {
    id: 'ORD' + Date.now(),
    created_at: new Date().toISOString(),
    customer: {name, phone, address},
    method,
    items, total
  };

  orders.unshift(order);
  localStorage.setItem('demo_orders_v1', JSON.stringify(orders));

  // clear cart
  cart = {};
  saveCart();
  renderCart();
  updateOrdersBadge();

  // success message
  document.getElementById('checkout-msg').innerHTML = '<div style="color:green">สั่งซื้อเรียบร้อย! หมายเลขคำสั่งซื้อ: ' + order.id + '</div>';
  setTimeout(()=>{ closeCheckout(); }, 1400);
}

/* ORDER HISTORY */
function updateOrdersBadge(){
  document.getElementById('orders-count').textContent = orders.length;
}
function viewOrders(){
  const wrap = document.getElementById('orders-list');
  wrap.innerHTML = '';
  if(orders.length === 0){
    wrap.innerHTML = '<div class="center muted">ยังไม่มีคำสั่งซื้อ</div>';
  } else {
    orders.forEach(o=>{
      const el = document.createElement('div');
      el.style.padding = '10px 0'; el.style.borderBottom = '1px solid #f0f4f2';
      el.innerHTML = `<div style="display:flex;justify-content:space-between"><div><b>${o.id}</b> • ${new Date(o.created_at).toLocaleString()}</div><div><b>${o.total} ฿</b></div></div>
        <div class="muted">ลูกค้า: ${o.customer.name} • ${o.customer.phone}</div>
        <div style="margin-top:6px">${o.items.map(it=>`<div style="font-size:14px">${it.title} x ${it.qty} = ${it.price*it.qty} ฿</div>`).join('')}</div>
      `;
      wrap.appendChild(el);
    });
  }
  document.getElementById('orders-backdrop').style.display = 'flex';
}
function closeOrders(){ document.getElementById('orders-backdrop').style.display = 'none'; }
function clearOrders(){ if(confirm('ลบประวัติการสั่งซื้อทั้งหมด?')){ orders = []; localStorage.setItem('demo_orders_v1', JSON.stringify(orders)); updateOrdersBadge(); closeOrders(); } }

/* quick QR placeholder switch (if you want to change) */
document.getElementById('pay-method').addEventListener('change', toggleQR);

/* expose small helpers to global (optional) */
window.addToCart = addToCart;
window.renderProducts = renderProducts;
</script>

</body>
</html>





